### Python 读、写、合并 Excel    ![origin.png]  > 需求背景：根据上述表格，将其按照供应商拆分成多个excel，保持原有格式 [openpyxl 参考链接](http://openpyxl.readthedocs.io/en/default/tutorial.html)  ##### 一、读写Excel方式：* xlrd 和 xlwt  ```text  仅支持对xls的操作，不支持xlsx  ```* openpyxl  ```text  支持对xlsx的操作  ```##### 二、openpyxl读写excel* **读excel**```python# -*- coding:utf-8 -*-from openpyxl import load_workbookdef get_sheet(dir, sheet_name):    """    To get sheet    :param dir: path    :param sheet_name: sheet, eg, Sheet1    :return:    """    workbook = load_workbook(dir)    worksheet = workbook.get_sheet_by_name(sheet_name)  # sheet    row_num = worksheet.max_row  # 获取行号    col_num = worksheet.max_col  # 获取列号    rows = workbook.rows  # 获取sheet的rows    # rows[0] ---> excel的第一行    return worksheet```* **写excel**```python# -*- coding:utf-8 -*-from openpyxl import Workbookwb_supplier = Workbook()sheet_supplier = wb_supplier.activeline = []sheet_supplier.append(line) # 最后一行添加wb_supplier.save()```* **设置excel样式**  > 目前实现的方式是按照单个cell进行的，若要对整行或者整列去设置，需要关闭excel后再进行（后续研究）```python# -*- coding:utf-8 -*-from openpyxl.styles import Font, Border, Side, PatternFill, Alignmentfrom openpyxl.utils import get_column_letter, column_index_from_stringdef set_header(worksheet, defaulting_font, defaulting_border, defaulting_alignment):    """    To set defaulting styles of the header    """    head = []    border = Border(left=Side(style='thin', color='FF000000'),                    right=Side(style='thin', color='FF000000'),                    top=Side(style='thin', color='FF000000'),                    bottom=Side(style='thin', color='FF000000'))    alignment = Alignment(horizontal='center', vertical='center', wrapText=True)  # 换行显示    # 写表头并设置其样式:字体、填充、边框、对齐方式    for index_column in range(len(head)):        worksheet.cell(row=1, column=index_column + 1, value=head[index_column])        worksheet.cell(row=1, column=index_column + 1).fill = PatternFill(fill_type='solid', fgColor='92D050')        worksheet.cell(row=1, column=index_column + 1).font = defaulting_font        worksheet.cell(row=1, column=index_column + 1).border = defaulting_border        worksheet.cell(row=1, column=index_column + 1).alignment = defaulting_alignment        worksheet.column_dimensions[get_column_letter(index_column+1)].width = 20.0  # 1 -> 'A'    # 设置行高    worksheet.row_dimensions[1].height = 30.0    # ------------------------------------------------------------------------------------    pos_start = 1    num = 'A'    pos_end = 2    worksheet.merge_cells(start_row=pos_start, start_column=column_index_from_string(num),                                      end_row=pos_end, end_column=column_index_from_string(num))```